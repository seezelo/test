<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Naver Directions Time-Optimal</title>

  <style>
    body {
      margin: 0;
      font-family: sans-serif;
    }
    #map {
      width: 100%;
      height: 400px;
    }
    #info {
      padding: 12px;
      background: #fafafa;
      border-top: 1px solid #ddd;
    }
  </style>

  <!-- âœ… ë„¤ì´ë²„ ì§€ë„ JS (ì¤‘ìš”: ncpKeyId) -->
  <script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=8vgpjrgiyy"></script>
</head>

<body>
  <h3 style="padding:10px;">ğŸš— ì‹œê°„ ê¸°ì¤€ ìµœì  ê²½ë¡œ í…ŒìŠ¤íŠ¸</h3>
  <div id="map"></div>
  <div id="info">ê²½ë¡œ ê³„ì‚° ì¤‘...</div>

  <script>
    /***********************
     * 1ï¸âƒ£ API í‚¤
     ***********************/
    const NCP_KEY_ID = "8vgpjrgiyy";
    const NCP_SECRET = "R9xfzjMz2isJRQAQqv4xVWU6Rf0oyD9NQGJXjja1";

    /***********************
     * 2ï¸âƒ£ ì¢Œí‘œ ì„¤ì •
     * (ê²½ë„,ìœ„ë„ ìˆœì„œ!!)
     ***********************/
    const start = "126.9780,37.5665"; // ì„œìš¸ì‹œì²­
    const goal  = "127.0276,37.4979"; // ê°•ë‚¨ì—­

    const waypoints = [
      "126.9900,37.5700", // ì¤‘ê°„ì§€ì 1
      "127.0100,37.5200"  // ì¤‘ê°„ì§€ì 2
    ];

    /***********************
     * 3ï¸âƒ£ ì§€ë„ ìƒì„±
     ***********************/
    const map = new naver.maps.Map("map", {
      center: new naver.maps.LatLng(37.5665, 126.9780),
      zoom: 12
    });

    /***********************
     * 4ï¸âƒ£ ê²½ë¡œ ìš”ì²­ (ì‹œê°„ ê¸°ì¤€)
     ***********************/
    async function fetchRoute() {
      const url =
        "https://naveropenapi.apigw.ntruss.com/map-direction/v1/driving" +
        `?start=${start}` +
        `&goal=${goal}` +
        `&waypoints=${waypoints.join("|")}` +
        `&option=trafast`;

      const res = await fetch(url, {
        headers: {
          "X-NCP-APIGW-API-KEY-ID": "8vgpjrgiyy",
          "X-NCP-APIGW-API-KEY": "R9xfzjMz2isJRQAQqv4xVWU6Rf0oyD9NQGJXjja1"
        }
      });

      return res.json();
    }

    /***********************
     * 5ï¸âƒ£ ì§€ë„ì— ê·¸ë¦¬ê¸°
     ***********************/
    fetchRoute().then(data => {
      const route = data.route.trafast[0];
      const summary = route.summary;

      // â± ì‹œê°„ í¬ë§·
      const minutes = Math.floor(summary.duration / 1000 / 60);
      const distanceKm = (summary.distance / 1000).toFixed(1);

      document.getElementById("info").innerHTML = `
        â± ì˜ˆìƒ ì†Œìš” ì‹œê°„: <b>${minutes}ë¶„</b><br>
        ğŸ“ ì´ë™ ê±°ë¦¬: <b>${distanceKm}km</b>
      `;

      // ì¢Œí‘œ ë³€í™˜
      const path = route.path.map(p =>
        new naver.maps.LatLng(p[1], p[0])
      );

      // ê²½ë¡œ ì„ 
      new naver.maps.Polyline({
        map,
        path,
        strokeWeight: 6,
        strokeOpacity: 0.8,
        strokeColor: "#007AFF"
      });

      // ì‹œì‘ / ë„ì°© ë§ˆì»¤
      new naver.maps.Marker({
        position: new naver.maps.LatLng(37.5665, 126.9780),
        map,
        title: "ì¶œë°œ"
      });

      new naver.maps.Marker({
        position: new naver.maps.LatLng(37.4979, 127.0276),
        map,
        title: "ë„ì°©"
      });
    })
    .catch(err => {
      document.getElementById("info").innerText =
        "âŒ ê²½ë¡œ ê³„ì‚° ì‹¤íŒ¨ (ì½˜ì†” í™•ì¸)";
      console.error(err);
    });
  </script>
</body>
